# android-movie-ticket

# 기능 요구 사항

사용자는 영화 예매 시스템을 이용해 쉽고 빠르게 보고 싶은 영화를 예매할 수 있다.

# 기능 구현 목록

- [x] 하나의 영화가 목록에서 보인다
    - [x] 영화 제목, 상영일, 러닝타임, 포스터의 정보를 담는 객체 작성
    - [x] 목록에 영화 정보를 표시한다
    - [x] 목록에 상영일을 표시한다
- [x] 지금 예매 버튼을 누르면 기본 정보를 담은 화면이 표시된다
    - [x] 영화 예매 화면으로 영화 제목과 상영일 정보를 넘긴다
- [x] 영화를 선택 후 나타나며, 예약할 인원을 선택할 수 있다.
    - [x] 최소 예약 인원은 1명이다.
- [x] 영화를 선택 후 날짜와 시간을 정할 수 있다.
- [x]  영화 티켓 한 장은 13,000원이다.
- [x] 화면이 회전되어도 입력한 정보는 유지되어야 한다.
- [x] 예매 완료를 확인하는 다이얼로그가 표시되고 배경을 터치해도 사라지지 않아야 한다.
- [x] 다이얼로그에서 예매 완료를 선택하면 예매 내역 화면으로 이동한다.

## 날짜 및 시간 정책

- [x] 각 영화의 상영일은 각자의 범위를 갖는다(예: 2025.4.1 ~ 2025.4.25).
- [x] 영화 상영 시간 범위는 오전 9시부터 자정(24시)까지다.
- [x] 주말에는 오전 9시부터 두 시간 간격으로 상영한다.
- [x] 평일에는 오전 10시부터 두 시간 간격으로 상영한다.
- [x] 날짜와 시간은 기본값(가장 빠른 날짜 및 시간)으로 초기화되어있다.

## step2 리팩터링 변경사항

- [x] UI와 도메인 로직 분리
    - [x] 포스터 이미지 리소스 ID를 도메인에서 분리
    - [x] 15분 취소 가능 시간 정보를 도메인으로 이동
    - [x] Activity의 도메인 로직들 이동
- [x] 에러로 빈 값을 주지 않도록 수정
- [x] 인텐트를 통한 데이터 전송시 직렬화 적용
- [x] Movie 어댑터에서 예약 버튼을 클릭시 전송되는 데이터의 모델링 적용
- [x] Activity의 너무 많은 양의 코드를 가지고 있는 함수 분리
- [x] lateinit을 사용한 코드 리팩터링
- [x] 하나의 테스트에서는 하나의 검증만 하도록 분리
- [x] UI 테스트 수정
    - [x] 화면 회전에 관한 테스트를 추가
    - [x] Activity 전환 테스트 삭제

- [x] 리스트뷰의 view holder 적용
- [x] activity가 dialog보다 먼저 종료되는 경우의 처리
- [x] getParcelableExtra의 확장함수를 구현하여 적용
- [x] 티켓 객체 생성시의 비논리오류를 예외를 던지는 대신 sealed calss로 처리

## step3 요구사항

- [x] step2 마지막 리뷰 반영
    - [x] convertView의 태그를 안전하게 참조할 수 있도록 수정
    - [x] ScreeningData에 Poster 데이터를 추가하여 전달하도록 수정
    -
- [x] MVP로 전체 프로젝트 리팩터링
    - [x] MainUI 코드를 MVP로 변환
    - [x] ReservationUI 코드를 MVP로 변환
    - [x] TicketUI 코드를 MVP로 변환
    - [x] 테스트 코드 추가

## step4 요구사항

- [x] 영화 목록 화면
    - [x] 영화가 세 번 노출될 때마다 광고를 한 번 노출한다.
    - [x] 영화 목록의 요소는 10,000개까지 추가될 수 있다.
- [x] 영화 예매 화면
    - [x] 사용자는 인원/날짜 선택 후에 좌석 선택 화면으로 이동한다.
    - [x] 좌석 선택 액티비티 이동시 확인 다이얼로그를 삭제한다
    - [x] 상영 정보(Screening)에 최대 예매 가능 수량 정보(20, 4행 5열)를 추가한다.
        - [x] 티켓은 최대 예매 가능 수량까지 선택이 가능하다
- [x] 좌석 선택 화면
    - [x] 좌석 레이아웃
        - [x] 좌석을 선택하면 배경색이 바뀌고, 하단에 선택한 좌석 수를 반영한 최종 가격이 표시된다.
        - [x] 좌석은 총 5행 4열로 구성되어 있고 각 행은 알파벳, 열은 숫자로 표현한다.
        - [x] 1, 2행은 B등급, 보라색 글자로 표시한다. (10,000원)
        - [x] 3, 4행은 S등급, 초록색 글자로 표시한다. (15,000원)
        - [x] 5행은 A등급, 파란색 글자로 표시한다. (12,000원)
        - [x] 선택된 좌석을 재선택하면 선택이 해제된다.
        - [x] 예매에서 선택한 티켓 수량을 초과하여 좌석을 선택할 수 없도록 한다.
    - [x] 전체 선택한 티켓 수량만큼 좌석이 선택되면 티켓 화면으로 이동하는 버튼을 활성화된다.
    - [x] 선택한 좌석 정보들을 Ticket 객체에 담아 티켓 Activity로 전달한다
        - [x] 티켓 화면으로 이동을 하기 전 다이얼로그를 표시한다
    - [x] 화면 회전시 선택한 좌석 정보가 유지된다
- [x] 티켓 화면
    - [x] 좌석 정보를 표시한다

- [x] 변경된 로직의 테스트 추가
    - [x] 도메인 로직 테스트 추가
    - [x] UI 테스트 추가

- [x] 최종 점검
    - [x] 불필요한 코드 삭제
    - [x] 잘못된 가시성 제한자 수정
    - [x] 로직 흐름에 따라 컨벤션 수정
    - [x] Readme 점검

## step4 리뷰 반영

- [x] 영화 예매 기능
    - [x] 영화 선택, 좌석 선택, 티켓 표시 기능을 MVP 패턴으로 전면 재구성
    - [x] 광고 삽입 로직을 뷰에서 모델 계층으로 이동
    - [x] 불필요한 View 파일을 feature 및 extension 패키지로 정리

- [x] ConstraintLayout으로 레이아웃 구조 개선
    - [x] `layout_weight` 적용
    - [x] 최대 선택 좌석 수 검증 로직 수정 (`>=` 사용)
    - [x] 좌석 객체에 방어적 복사 적용
    - [x] 좌석 등급 및 가격 계산 로직 개선

- [x] 전반적인 코드 정리 및 리팩터링
    - [x] 잘못된 패키지 경로 및 클래스명 수정
    - [x] 패키지 구조 변경 및 Contract 내부로 View 인터페이스 이동
    - [x] 동반 객체의 유저에게 표시되는 메시지를 `string.xml`로 이동
    - [x] 중복 import 및 불필요한 메서드/클래스 제거
    - [x] 메서드명 및 변수명 명확하게 개선
    - [x] 테스트 코드 변경 사항 반영
    - [x] mockk 라이브러리 의존성 관리 방식 변경 (`libs.versions`)
